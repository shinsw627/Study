# TIL 20211108 Kubernetes

### **ğŸ“Œ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ë“±ì¥**

**ì¿ ë²„ë„¤í‹°ìŠ¤(Kubernetes)**ëŠ” ì—¬ëŸ¬ ì„œë²„ë¡œ êµ¬ì„±ëœ í´ëŸ¬ìŠ¤í„° í™˜ê²½ì—ì„œ ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìë™ ë””í”Œë¡œì´, ìŠ¤ì¼€ì¼ë§ ë“±ì˜ ê´€ë¦¬ë¥¼ í•˜ê¸° ìœ„í•œ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í”Œë«í¼ì´ë‹¤.Â íŠ¹íˆ ì„ ì–¸ì  êµ¬ì„±ê³¼ ìë™í™”ë¥¼ ëª¨ë‘ ìš©ì´í•˜ê²Œ í•´ì¤€ë‹¤. ê·¸ì „ì— ìš°ì„  ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°°í¬ ëª¨ë¸ë¶€í„° ì•Œì•„ë³´ì.

[https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FL16Rl%2Fbtq0TvNkrPY%2FgO21AdXzKOjh3DhvdchBo1%2Fimg.png](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FL16Rl%2Fbtq0TvNkrPY%2FgO21AdXzKOjh3DhvdchBo1%2Fimg.png)

https://kubernetes.io/ko/docs/concepts/overview/what-is-kubernetes/

ì»¨í…Œì´ë„ˆ ë°°í¬ ëª¨ë¸ì„ ì´ì•¼ê¸°í•˜ê¸° ìœ„í•´ì„œëŠ” í•œì°¸ ì „ìœ¼ë¡œ ê±°ìŠ¬ëŸ¬ ì˜¬ë¼ê°€ ì „í†µì ì¸ ë°°í¬ ëª¨ë¸ë¶€í„° ì´ì•¼ê¸°í•´ì•¼í•œë‹¤. ì´ˆê¸°ì˜ ì „í†µì ì¸ ë°°í¬ëª¨ë¸ì€ í•˜ë‚˜ì˜ ë¬¼ë¦¬ ì„œë²„ì— ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í–ˆë‹¤. ë‹¹ì—°íˆ í•˜ë‚˜ì˜ ë¬¼ë¦¬ì„œë²„ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ í• ë‹¹í•˜ê³  ì œí•œí•˜ëŠ” ë°©ë²•ì´ ì—†ì—ˆê¸° ë•Œë¬¸ì—Â **ê°€ìƒí™”**ê°€ ë“±ì¥í•˜ê²Œ ë˜ì—ˆë‹¤.

ê°€ìƒí™”ëœ ë°°í¬ ëª¨ë¸ë¡œ ë°”ë€Œë©´ì„œ í•˜ë‚˜ì˜ í˜¸ìŠ¤íŠ¸ì—ì„œÂ VMê°„ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê²©ë¦¬í•˜ì—¬ ì‹¤í–‰í•˜ì˜€ë‹¤. ê° VMì€ ê°€ìƒí™”ëœ í•˜ë“œì›¨ì–´ ìƒì—ì„œ ìì²´ ìš´ì˜ì²´ì œë¥¼ í¬í•¨í•˜ëŠ” í•˜ë‚˜ì˜ ì™„ì „í•œ ë¨¸ì‹ ì´ë‹¤. ë…ë¦½ì ì´ë©° ê²©ë¦¬ë˜ì—ˆê¸° ë•Œë¬¸ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì •ë³´ë¥¼ ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ììœ ë¡­ê²Œ ì•¡ì„¸ìŠ¤ í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì¼ì • ìˆ˜ì¤€ì˜ ë³´ì•ˆì„±ë„ ì œê³µí•  ìˆ˜ ìˆì—ˆë‹¤. ê°€ìƒí™”ë¥¼ í†µí•´ ë¬¼ë¦¬ì„œë²„ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆì—ˆê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ëŠ” ê³¼ì •ì´ ìˆ˜ì›”í•´ì¡Œë‹¤.

í•˜ì§€ë§Œ ì„¸ìƒì€ ì—¬ê¸°ì„œ ë©ˆì¶”ì§€ ì•Šì•˜ë‹¤. ë” ê°€ë³ê³  ë” ìˆ˜ì›”í•œ ë°°í¬ í™˜ê²½ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œÂ **ì»¨í…Œì´ë„ˆ**ê°€ ë“±ì¥í•˜ì˜€ë‹¤. ì»¨í…Œì´ë„ˆëŠ” ê²©ë¦¬ëœ í™˜ê²½ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œë‹¤ëŠ” ì ì´Â VMê³¼ ìœ ì‚¬í•˜ë‹¤. ê²°ì •ì ìœ¼ë¡œ ë‹¤ë¥¸ ê²ƒì€ ì»¨í…Œì´ë„ˆëŠ” í˜¸ìŠ¤íŠ¸ ìš´ì˜ì²´ì œë¥¼ ê³µìœ í•œë‹¤. **ë”°ë¼ì„œ VMì— ë¹„í•´ ê°€ë³ë‹¤ê³  ë§í•œë‹¤. ê°€ë³ë‹¤ëŠ” ì¥ì  ë•ë¶„ì— ì—¬ëŸ¬ ì„œë²„ì— ë³µì œ ë° ë°°í¬í•˜ì—¬ ì´ì‹í•  ìˆ˜ ìˆë‹¤**.

ì´ëŸ¬í•œ ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ë“±ì¥í•˜ì˜€ë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ë‹¤ìˆ˜ì˜ ì„œë²„ ìœ„ì—ì„œ ì‹¤í–‰í•˜ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•˜ëŠ” ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ì„ ìˆ˜í–‰í•œë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ í†µí•´ ì»¨í…Œì´ë„ˆì˜ ë°°í¬ë¶€í„°, í™•ì¥, ìŠ¤ì¼€ì¤„ë§, ë„¤íŠ¸ì›Œí¬ ì„¤ì • ë“±ì„ ìë™í™”í•  ìˆ˜ ìˆë‹¤.

### **ğŸ“ŒÂ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ê¸°ë³¸ ê°œë…**

ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ê°€ì¥ í•µì‹¬ì€Â **Desired State(ì›í•˜ëŠ” ìƒíƒœ)**ì´ë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ desired stateëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìµœì¢… ë°°í¬ ìƒíƒœë¥¼ ì˜ë¯¸í•˜ëŠ”ë°, ì‚¬ìš©ìê°€ ì›í•˜ëŠ” desired stateë¥¼ ì¿ ë²„ë„¤í‹°ìŠ¤ì—ê²Œ ì•Œë ¤ì£¼ë©´ ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ”Â **Current State(í˜„ì¬ ìƒíƒœ)**ê°€ desired stateì™€ ë™ì¼í•˜ê²Œ ë˜ë„ë¡ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. ì¦‰ ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ì•Œì•„ì„œ ì¥ì• ë¥¼ ë³µêµ¬í•´ì¤€ë‹¤. ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ì£¼ì²´ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì¸ë° ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” control-loopë¥¼ ëŒë©° ë¦¬ì†ŒìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•œë‹¤.

https://theithollow.com/2019/09/16/kubernetes-desired-state-and-control-loops/

[https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FJYmTi%2Fbtq0Ucz18cj%2FfY95ItsXfcYPSwYsUDob9k%2Fimg.png](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FJYmTi%2Fbtq0Ucz18cj%2FfY95ItsXfcYPSwYsUDob9k%2Fimg.png)

### **ğŸ“ŒÂ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ êµ¬ì¡°**

ì•ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ì—¬ëŸ¬ ì„œë²„ì— ê±¸ì³ ì‹¤í–‰ë˜ëŠ” ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê´€ë¦¬í•œë‹¤ê³  í•˜ì˜€ë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ëŠ” ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ë“¤ë¡œ ì´ë£¨ì–´ì ¸ìˆìœ¼ë©° ì´ë“¤ì´ ì¡´ì¬í•˜ëŠ” ì„œë²„ë¥¼Â **ë§ˆìŠ¤í„° ë…¸ë“œ(ì„œë²„)**ì™€Â **ì›Œì»¤ ë…¸ë“œ(ì„œë²„)**ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. í”íˆ ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ì„œë²„ë¥¼Â **ê°€ì¶•**ì— ë¹„ìœ í•˜ëŠ”ë° í•˜ë‚˜ì˜ ë¬´ë¦¬ë¡œ ê´€ë¦¬í•˜ëŠ” ê°€ì¶•ì€ í•œë§ˆë¦¬ë§ˆë‹¤ ì´ë¦„ì„ ì •í•´ë‘ëŠ” ê²ƒë„ ì•„ë‹ˆê³  íŠ¹ë³„í•œ ê´€ë¦¬ë¥¼ í•˜ëŠ” ê²ƒë„ ì•„ë‹ˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ë„ ê°ê°ì˜ ì„œë²„ê°€ íŠ¹ë³„í•œ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë‹¨ìˆœíˆ í•˜ë‚˜ì˜ ì‘ì—…ì„ ë‚˜ëˆ„ì–´ ìˆ˜í–‰í•œë‹¤. ì„œë²„ í•˜ë‚˜ë¥¼ íŠ¹ë³„í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ì£½ìœ¼ë©´ ìƒˆë¡œ ì„œë²„ë¥¼ êµ¬ì¶•í•˜ëŠ” í˜•íƒœì¸ ê²ƒì´ë‹¤.

[https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FpJiPg%2Fbtq0SlR28bv%2Fxa9cuw0iQzxFzZQNL52dSK%2Fimg.png](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FpJiPg%2Fbtq0SlR28bv%2Fxa9cuw0iQzxFzZQNL52dSK%2Fimg.png)

https://kubernetes.io/ko/docs/concepts/overview/components/

### Master Node

ë§ˆìŠ¤í„° ë…¸ë“œ(master node)ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ í´ëŸ¬ìŠ¤í„° ì „ì²´ë¥¼ ì»¨íŠ¸ë¡¤í•˜ëŠ” ì‹œìŠ¤í…œìœ¼ë¡œ ë³´í†µ ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•œë‹¤. í•˜ë‚˜ì˜ ì„œë²„ë¡œ êµ¬ì¶•í•´ë„ ë¬¸ì œëŠ” ì—†ì§€ë§Œ ê³ ê°€ìš©ì„±ì„ ìœ„í•´ ì—¬ëŸ¬ëŒ€ì˜ ì„œë²„ì— êµ¬ì¶•í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤. ë§ˆìŠ¤í„° ë…¸ë“œì— ì¡´ì¬í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

**kube-apiserver**

api ì„œë²„ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ apië¥¼ ë…¸ì¶œí•˜ì—¬ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë“¤ë¡œë¶€í„° ì˜¤ëŠ” ì´ë²¤íŠ¸ì— ëŒ€í•´ ì‘ë‹µí•˜ëŠ” ì—­í• ì„ í•œë‹¤. í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” api ì„œë²„ê°€ ì¤‘ì‹¬ì´ ë˜ì–´ ì»´í¬ë„ŒíŠ¸ë“¤ì˜ í†µì‹ ì´ ì´ë£¨ì–´ì§„ë‹¤. ì»´í¬ë„ŒíŠ¸ë¼ë¦¬ ë¿ë§Œ ì•„ë‹ˆë¼ ì‚¬ìš©ìì™€ì˜ ìƒí˜¸ì‘ìš©ë„ api ì„œë²„ì—ì„œ ë‹´ë‹¹í•œë‹¤. ì‚¬ìš©ìê°€ ì…ë ¥í•œ ëª…ë ¹ì„ ë°›ì•„ì„œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ì²˜ë¦¬ ì‘ë‹µì„ ì „ë‹¬í•´ì¤€ë‹¤. ë˜í•œ kube-apiserverëŠ” ìˆ˜í‰ìœ¼ë¡œ í™•ì¥ë˜ë„ë¡ ë””ìì¸ë˜ì—ˆë‹¤. ì¦‰, ë” ë§ì€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°°í¬í•´ì„œ í™•ì¥í•  ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ kube-apiserver ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ê³ , ì¸ìŠ¤í„´ìŠ¤ê°„ì˜ íŠ¸ë˜í”½ì„ ê· í˜•ìˆê²Œ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.

> ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì„ ì–¸í˜• ëª…ë ¹ì–´ kubectl
> 

**etcd(ì €ì¥ì†Œ)**

etcdëŠ” ëª¨ë“  í´ëŸ¬ìŠ¤í„° ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ì €ì¥ì†Œ(DB) ì—­í• ì„ ìˆ˜í–‰í•œë‹¤. í”íˆ ìƒê°í•˜ëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤(Relational Database)ê°€ ì•„ë‹ˆë¼ key-value ì €ì¥ì†Œì´ë‹¤. ê³ ê°€ìš©ì„±ì„ ìœ„í•´ etcdë¥¼ êµ¬ì¶•í•˜ì—¬ ë°±ì—…ì„ í•  ìˆ˜ ìˆë‹¤.

**kube-scheduler**

ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ìƒì„±ë˜ì—ˆì§€ë§Œ ë°°ì •ë˜ì§€ ëª»í•˜ì—¬ ì‹¤í–‰ë˜ì§€ ì•Šì€ ì»¨í…Œì´ë„ˆë¥¼ ê°ì§€í•˜ê³  ì‹¤í–‰í•  ë…¸ë“œë¥¼ ì„ íƒí•˜ëŠ” ì—­í• ì„ í•œë‹¤. ìŠ¤ì¼€ì¤„ë§ ê²°ì •ì„ ìœ„í•´ì„œ ê³ ë ¤ë˜ëŠ” ìš”ì†ŒëŠ” ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ê°œë³„ ë° ì´ì²´ì  ìš”êµ¬ ì‚¬í•­, ë…¸ë“œì˜ ìƒíƒœ, ì œì•½ ì¡°ê±´ë“±ì„ í¬í•¨í•œë‹¤.

**kube-controller-manager(ì»¨íŠ¸ë¡¤ëŸ¬ ì§‘í•©)**

ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ êµ¬ë™í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¡œ, ì•ì—ì„œ ì„¤ëª…í•œ control-loopë¥¼ ëŒë©´ì„œ current stateê°€ desired stateë¡œ ë˜ë„ë¡ ë°”ê¾¸ì–´ì£¼ëŠ” ì—­í• ì„ ë‹´ë‹¹í•œë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì¢…ë¥˜ì—ë„ ì—¬ëŸ¬ê°€ì§€ê°€ ì¡´ì¬í•˜ëŠ”ë° ë…¼ë¦¬ì ìœ¼ë¡œ ê° ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ê°œë³„ í”„ë¡œì„¸ìŠ¤ì´ì§€ë§Œ ë³µì¡ì„±ì„ ë‚®ì¶”ê¸° ìœ„í•´ ëª¨ë‘ ë‹¨ì¼ ë°”ì´ë„ˆë¦¬ë¡œ ì»´íŒŒì¼ë˜ê³  ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ ì‹¤í–‰ëœë‹¤.

- ë…¸ë“œ ì»¨íŠ¸ë¡¤ëŸ¬: ë…¸ë“œê°€ ë‹¤ìš´ë˜ì—ˆì„ ë•Œì— ëŒ€ì‘í•œë‹¤.
- ë ˆí”Œë¦¬ì¼€ì´ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬: ë ˆí”Œë¦¬ì¼€ì´ì…˜ ì˜¤ë¸Œì íŠ¸ì—ì„œ ì•Œë§ì€ ìˆ˜ì˜ Podë¥¼ ìœ ì§€í•œë‹¤.
- ì—”ë“œí¬ì¸íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬: ì„œë¹„ìŠ¤ì™€ Podë¥¼ ì—°ê²°í•œë‹¤.
- ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ & í† í° ì»¨íŠ¸ë¡¤ëŸ¬: ìƒˆë¡œìš´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•œ ê¸°ë³¸ ê³„ì •ê³¼ API ì ‘ê·¼ í† í°ì„ ìƒì„±í•œë‹¤.

**cloud-controller-manager(í´ë¼ìš°ë“œ ì»¨íŠ¸ë¡¤ëŸ¬)**

í´ë¼ìš°ë“œë³„ ì»¨íŠ¸ë¡¤ ë¡œì§ì„ í¬í•¨í•˜ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤Â ì»¨íŠ¸ë¡¤ í”Œë ˆì¸Â ì»´í¬ë„ŒíŠ¸ì´ë‹¤. í´ë¼ìš°ë“œ ì»¨íŠ¸ë¡¤ëŸ¬ ë§¤ë‹ˆì €ë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„°ë¥¼ í´ë¼ìš°ë“œì— ì—°ê²°í•˜ì—¬ í´ë¼ìš°ë“œ í”Œë«í¼ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì¶”ê°€ ë° ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.Â kube-controller-managerì™€ ë§ˆì°¬ê°€ì§€ë¡œ cloud-controller-managerë„ ë…¼ë¦¬ì ìœ¼ë¡œ ë…ë¦½ì ì¸ ì—¬ëŸ¬ control-loopë¥¼ ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰í•˜ëŠ” ë‹¨ì¼ ë°”ì´ë„ˆë¦¬ë¡œ ê²°í•©í•œë‹¤.

ë‹¤ìŒ ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì€ í´ë¼ìš°ë“œ í”Œë«í¼ì˜ ì˜ì¡´ì„±ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

- ë…¸ë“œ ì»¨íŠ¸ë¡¤ëŸ¬: ë…¸ë“œê°€ ì‘ë‹µì„ ë©ˆì¶˜ í›„ í´ë¼ìš°ë“œ ìƒì—ì„œ ì‚­ì œë˜ì—ˆëŠ”ì§€ íŒë³„í•˜ê¸° ìœ„í•´ í´ë¼ìš°ë“œ ì œê³µ ì‚¬ì—…ìì—ê²Œ í™•ì¸í•˜ëŠ” ê²ƒ
- ë¼ìš°íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬: ê¸°ë³¸ í´ë¼ìš°ë“œ ì¸í”„ë¼ì— ê²½ë¡œë¥¼ êµ¬ì„±í•˜ëŠ” ê²ƒ
- ì„œë¹„ìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬: í´ë¼ìš°ë“œ ì œê³µ ì‚¬ì—…ì ë¡œë“œë°¸ëŸ°ì„œë¥¼ ìƒì„±, ì—…ë°ì´íŠ¸ ê·¸ë¦¬ê³  ì‚­ì œí•˜ëŠ” ê²ƒ

### Worker Node

ì›Œì»¤ ë…¸ë“œëŠ” ë§ˆìŠ¤í„°ë¡œë¶€í„° ì „ë‹¬ë°›ì€ ëª…ë ¹ì— ë”°ë¼ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•œë‹¤.

**kubelet(ë…¸ë“œ ê´€ë¦¬ì)**

í´ëŸ¬ìŠ¤í„°ì˜ ê°Â ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” í•µì‹¬ ì»´í¬ë„ŒíŠ¸ë¡œÂ ë‹¤ì–‘í•œ ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•´ ì œê³µëœ ëª…ì„¸(Spec)ì˜ ì§‘í•©ì„ ë°›ì•„ì„œÂ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤. ì—¬ê¸°ì„œ ëë‚˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³  ì£¼ê¸°ì ìœ¼ë¡œ ë§ˆìŠ¤í„° ë…¸ë“œì˜ api ì„œë²„ì™€ í†µì‹ í•˜ì—¬ ì •ë³´ë¥¼ ì£¼ê³ ë°›ëŠ”ë‹¤.

**kube-proxy(ë„¤íŠ¸ì›Œí¬ í”„ë¡ì‹œ)**

í´ëŸ¬ìŠ¤í„°ì˜ ê°Â ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ í”„ë¡ì‹œë¡œ, ì¿ ë²„ë„¤í‹°ìŠ¤ì˜Â ì„œë¹„ìŠ¤ ì˜¤ë¸Œì íŠ¸ë¥¼ êµ¬í˜„í•œë‹¤. ì¦‰ ë…¸ë“œì˜ ë„¤íŠ¸ì›Œí¬ ê·œì¹™ì„ ê´€ë¦¬í•˜ì—¬ ì„œë¹„ìŠ¤ë§ˆë‹¤ ê°œë³„ IPë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê²Œ ë§Œë“¤ì–´ì£¼ê³  í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ë‚˜ ì™¸ë¶€ì˜ íŠ¸ë˜í”½ì„ Podë¡œ ì „ë‹¬í•  ìˆ˜ìˆë„ë¡ í•´ì¤€ë‹¤.

**container runtime(ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„)**

ì‹¤ì œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ì„ ë‹´ë‹¹í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë„ì»¤, CRI-O ë“±ì´ ìˆë‹¤.

### **ğŸ“ŒÂ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì¥ì **

1. **ì‹¤í–‰í™˜ê²½ ê³ ë¦½í™”**Â ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ê°œë³„ ì‹¤í–‰ í™˜ê²½ì— ê³ ë¯¼í•  í•„ìš”ì—†ì´ ì–´ë””ì„œë“  ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì‹¤í–‰ í™˜ê²½ ìì²´ê°€ ê°€ìƒ í™˜ê²½ì— í¬í•¨ë˜ì–´ìˆê¸° ë•Œë¬¸ì´ë‹¤.
2. **ë¦¬ì†ŒìŠ¤ ê´€ë¦¬**Â ìì²´ì ìœ¼ë¡œ ì—¬ëŸ¬ ì„œë²„ì— ë‚˜ë‰˜ì–´ì§„ ë¦¬ì†ŒìŠ¤ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•´ì£¼ë¯€ë¡œ ìˆ˜ì›”í•˜ê²Œ í´ëŸ¬ìŠ¤í„°ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.
3. **ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ì™€ ë¡œë“œ ë°¸ëŸ°ì‹±**Â ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” DNSë‚˜ IP ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ë…¸ì¶œí•  ìˆ˜ ìˆë‹¤. ì»¨í…Œì´ë„ˆë¡œ ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½ì´ ë§ìœ¼ë©´ ë¡œë“œ ë°¸ëŸ°ì‹±ì„ í†µí•´ ì•ˆì •ì ì¸ ë°°í¬ê°€ ì´ë£¨ì–´ì§€ë„ë¡ í•œë‹¤.
4. **ìŠ¤í† ë¦¬ì§€ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜**Â ë¡œì»¬ ì €ì¥ì†Œë‚˜ í´ë¼ìš°ë“œì˜ ì €ì¥ì†Œì™€ ê°™ì´ ì›í•˜ëŠ” ì €ì¥ì†Œ ì‹œìŠ¤í…œì„ ìë™ìœ¼ë¡œ íƒ‘ì¬ í•  ìˆ˜ ìˆë‹¤.
5. **ìë™í™”ëœ ë¡¤ì•„ì›ƒê³¼ ë¡¤ë°±**Â ë°°í¬ëœ ì»¨í…Œì´ë„ˆì˜ current stateë¥¼ desired stateë¡œ ìœ ì§€í•˜ê¸° ìœ„í•´ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³  ì²˜ë¦¬í•˜ì—¬ ìë™í™”ëœ ë¡¤ë°±ì„ ì§€ì›í•œë‹¤.
6. **ì¥ì•  ëŒ€ì‘ ìˆ˜ì›”**Â í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì„ ì œí•œí•¨ìœ¼ë¡œì¨ ì¥ì•  ë°œìƒì‹œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— ì˜í–¥ì„ ë¼ì¹˜ì§€ ì•Šë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ë” ë‚˜ì•„ê°€ì„œëŠ” ë…¸ë“œì— ì´ìƒì´ ìƒê¸°ë©´ ì„œë²„ ìì²´ë¥¼ ë°”ê¾¸ë©´ ë˜ë¯€ë¡œ ì¥ì• ì— ìˆ˜ì›”í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆë‹¤.
7. **ìë™í™”ëœ ë³µêµ¬(self-healing)**Â ì‹¤íŒ¨í•œ ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ì‹œì‘í•˜ê³  ë¬¸ì œê°€ ë°œìƒí•œ ì»¨í…Œì´ë„ˆë¥¼ êµì²´í•˜ë©° ìƒíƒœ ê²€ì‚¬ì— ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ì»¨í…Œì´ë„ˆë¥¼ ì£½ì´ëŠ” ë“±ì˜ ë™ì‘ì„ í†µí•´ í´ëŸ¬ìŠ¤í„°ì˜ desired stateë¥¼ ìœ ì§€í•œë‹¤.
8. **ë°°í¬ ìë™í™”**Â ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ìë™ìœ¼ë¡œ ë…¸ë“œë¥¼ ì„ íƒí•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ë°°ì¹˜í•˜ë¯€ë¡œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°°í¬ë¥¼ ìë™í™”í•  ìˆ˜ ìˆë‹¤.

### **ğŸ“Œ Pod ê¸°ë³¸ ê°œë…**

PodëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ìµœì†Œ ì‹¤í–‰ ë‹¨ìœ„ë¡œ ì»¨í…Œì´ë„ˆë¥¼ í¬í•¨í•œë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ê°œë³„ë¡œ í•˜ë‚˜ì”© ë°°í¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ Pod ë‹¨ìœ„ë¡œ ë°°í¬í•˜ëŠ”ë° ì•„ë¬´ë¦¬ ì‘ì€ í”„ë¡œì„¸ìŠ¤ë¼ë„ Podë¥¼ í†µí•´ ì‹¤í–‰í•´ì•¼ í•œë‹¤. ì¦‰ Podë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ëŠ” ê¸°ë³¸ ê°€ìƒ í™˜ê²½ì„ ì œê³µí•˜ëŠ” ê²ƒì´ë‹¤. Podì˜ íŠ¹ì§•ì€ ì•„ë˜ì™€ ê°™ë‹¤.

1ï¸âƒ£Â **í•œ ê°œ ì´ìƒì˜ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰**

PodëŠ” í•œ ê°œ ì´ìƒì˜ ì»¨í…Œì´ë„ˆë¥¼ í¬í•¨í•˜ëŠ”ë° ë³´í†µ í•œ ê°œì˜ Podë‹¹ í•œ ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ ê°€ì§€ëŠ”ë° ë§ê²ŒëŠ” 3ê°œê¹Œì§€ ê°€ì§€ê¸°ë„ í•œë‹¤. ë¬¼ë¡  3ê°œë³´ë‹¤ ë” ë§ì´ ì‹¤í–‰í•  ìˆ˜ë„ ìˆì§€ë§Œ ì˜ ì“°ì´ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤. íŠ¹íˆ ì—¬ëŸ¬ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ê²½ìš° ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ì‹¤í–‰ ìˆœì„œë¥¼ ë³´ì¥í•˜ì§€ëŠ” ì•Šê¸° ë•Œë¬¸ì— ë¨¼ì € ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ì»¨í…Œì´ë„ˆê°€ ìˆëŠ” ê²½ìš° initContainerë¥¼ í†µí•´ ëª…ì‹œì ìœ¼ë¡œ ì´ˆê¸°í™” ì‘ì—…ì„ ìˆ˜í–‰í•´ì£¼ì–´ì•¼ í•œë‹¤.

2ï¸âƒ£Â **ë™ì¼ ë…¸ë“œì— í• ë‹¹**

Podì— í¬í•¨ëœ ì»¨í…Œì´ë„ˆë“¤ì€ ë™ì¼í•œ ë…¸ë“œì— í• ë‹¹ëœë‹¤. ë˜í•œ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ê²Œ ë˜ì–´ Podê°€ ì‚­ì œë˜ë©´ Podì— í¬í•¨ëœ ì»¨í…Œì´ë„ˆê°€ ëª¨ë‘ ì‚­ì œëœë‹¤.

3ï¸âƒ£Â **Podë§Œì˜ ê³ ìœ  IP í• ë‹¹**

PodëŠ” ë…¸ë“œì™€ëŠ” ë³„ê°œë¡œ ê³ ìœ í•œ IPë¥¼ í• ë‹¹ë°›ì•„ Podì— ì§ì ‘ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. í¬íŠ¸í¬ì›Œë”©ê³¼ ê°™ì€ ë°©ë²•ì´ í•„ìš”ì—†ì´ ë‹¤ë¥¸ ë…¸ë“œì— ìˆëŠ” Podë“¤ë„ ì„œë¡œì˜ ê³ ìœ í•œ IPë¥¼ í†µí•´ í†µì‹ í•  ìˆ˜ ìˆë‹¤.

4ï¸âƒ£Â **Pod ë‚´ì˜ ì»¨í…Œì´ë„ˆê°„ IP ê³µìœ **

í•˜ë‚˜ì˜ Pod ë‚´ì— ìˆëŠ” ì»¨í…Œì´ë„ˆë“¤ì€ IPë¥¼ ê³µìœ í•œë‹¤. ë”°ë¼ì„œ localhostë¡œ ì»¨í…Œì´ë„ˆê°„ í†µì‹ ì´ ê°€ëŠ¥í•˜ë‹¤. ì»¨í…Œì´ë„ˆëŠ” Portë¥¼ í†µí•´ êµ¬ë¶„í•œë‹¤.

5ï¸âƒ£Â **ë³¼ë¥¨ ê³µìœ **

Pod ë‚´ì— ì¡´ì¬í•˜ëŠ” ì»¨í…Œì´ê°„ì—ëŠ” ë””ìŠ¤í¬ ë³¼ë¥¨ì„ ê³µìœ í•  ìˆ˜ ìˆë‹¤. ê¸°ì¡´ì˜ ì»¨í…Œì´ë„ˆë¡œ ë¶„ë¦¬ëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì»¨í…Œì´ë„ˆê°„ íŒŒì¼ ì‹œìŠ¤í…œì´ ë¶„ë¦¬ë˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì˜ ë³¼ë¥¨ì— ì ‘ê·¼í•  ìˆ˜ ì—†ì—ˆë‹¤. í•˜ì§€ë§Œ Podì—ì„œëŠ” ì»¨í…Œì´ë„ˆë“¤ì´ ë™ì¼í•œ ë³¼ë¥¨ì„ ì‚¬ìš©í•˜ì—¬ ì—°ê²°ë˜ê³  ê³µìœ í•œë‹¤.

ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤ëŠ” YAML í˜•íƒœì˜ ì •ì˜ì„œë¡œ í‘œí˜„ë  ìˆ˜ ìˆë‹¤. ê·¸ ì¤‘ì—ì„œ Podë¥¼ ì‚´í´ë³´ì. ì•„ë˜ëŠ” nginx ì´ë¯¸ì§€ë¡œ ìƒì„±í•œ ì»¨í…Œì´ë„ˆë¥¼ í•œ ê°œ ê°€ì§€ê³  ìˆëŠ” ê°„ë‹¨í•œ Pod YAML ì •ì˜ì„œì´ë‹¤.

[https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FUffF6%2Fbtq1E8vXxux%2FJEzlEkuhgwNUIekRBSsPBk%2Fimg.png](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FUffF6%2Fbtq1E8vXxux%2FJEzlEkuhgwNUIekRBSsPBk%2Fimg.png)

- apiVersion: ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ API ë²„ì „ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ê°„ ì¶©ëŒì„ í”¼í•˜ê¸° ìœ„í•œ scope
- kind: ë¦¬ì†ŒìŠ¤ ì¢…ë¥˜ ì •ì˜
- metadata: ë¦¬ì†ŒìŠ¤ì˜ ë©”íƒ€ ë°ì´í„° ì •ì˜(ë¼ë²¨, ì´ë¦„ ë“±)
- spec: ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ìƒì„¸ ìŠ¤í™ ì •ì˜(Podì—ì„œëŠ” ìƒì„±í•˜ëŠ” ì»¨í…Œì´ë„ˆì˜ ì •ë³´ ë“±ì„ í¬í•¨)

> ğŸ™‹â€â™‚ï¸ nginxê°€ ë­”ê°€ìš”?
> 
> 
> nginxëŠ” ê°€ë²¼ì›€ê³¼ ë†’ì€ ì„±ëŠ¥ì„ ëª©í‘œë¡œ í•˜ëŠ” ì›¹ ì„œë²„ ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ë™ì‹œì ‘ì† ì²˜ë¦¬ì— íŠ¹í™”ë˜ì—ˆë‹¤. ì›¹ ì„œë²„, ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ë° ë©”ì¼ í”„ë¡ì‹œ ê¸°ëŠ¥ì„ ê°€ì§„ë‹¤. Apacheì™€ ë¹„ìŠ·í•œ ì—­í• ì„ í•˜ëŠ”ë°, nginxëŠ” ì˜¤ë˜ì „ì— ë§Œë“¤ì–´ì§„ ì•„íŒŒì¹˜ì˜ ëŒ€í•­ë§ˆë¡œ ë“±ì¥í•˜ì˜€ë‹¤. ì‹œëŒ€ì˜ ìš”êµ¬ì‚¬í•­ì— ë¶€ì‘í•˜ì—¬ ë“±ì¥í•œ ë§Œí¼ ë” ì ì€ ìì›ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë°ì´í„°ë¥¼ ì„œë¹„ìŠ¤í•  ìˆ˜ ìˆëŠ” íŠ¹ì§•ì´ ìˆë‹¤.
> 

ì •ì˜í•œ YAML íŒŒì¼ë¡œ Podë¥¼Â ìƒì„±í•´ë³´ì.

[https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FeIXalR%2Fbtq1C2J1Tuj%2F1oyhjmLR2Z52PoWtgI2z80%2Fimg.png](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FeIXalR%2Fbtq1C2J1Tuj%2F1oyhjmLR2Z52PoWtgI2z80%2Fimg.png)

ì´ë ‡ê²Œ ì§ì ‘ YAMLì„ ì‘ì„±í•´ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ë„ ìˆì§€ë§Œ kubectl run ëª…ë ¹ì˜ --dry-runê³¼ -oyaml ì˜µì…˜ ì¡°í•©ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‹¤ì œë¡œÂ  ìƒì„±í•˜ì§€ ì•Šê³  í…œí”Œë¦¿ë§Œ ìƒì„±í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.

![Untitled](TIL%2020211108%20Kubernetes%2068f3756517e94adb9681cd46b3c3e08d/Untitled.png)

ì¢‹ì€ ê·¸ë¦¼ì´ë¼ ë“¤ê³ ì™€ ë´¤ë‹¤.

ì¿ ë²„ë„¤í‹±ìŠ¤ëŠ” container orchestration ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.
ìë™í™”ëœ ì»¨í…Œì´ë„ˆ ë°°í¬ ìŠ¤ì¼€ì¼ë§ ê´€ë¦¬ í•´ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ì‹œìŠ¤í…œì´ë‹¤.

ì„ ì–¸ì API

![Untitled](TIL%2020211108%20Kubernetes%2068f3756517e94adb9681cd46b3c3e08d/Untitled%201.png)